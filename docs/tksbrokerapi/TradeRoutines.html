<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.5.1"/>
    <title>tksbrokerapi.TradeRoutines API documentation</title>
            <link rel="icon" href="https://github.com/Tim55667757/TKSBrokerAPI/blob/develop/docs/media/favicon-128x128.png?raw=true"/>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#49483e}.pdoc-code{background:#272822; color:#f8f8f2}.pdoc-code .c{color:#75715e}.pdoc-code .err{color:#960050; background-color:#1e0010}.pdoc-code .esc{color:#f8f8f2}.pdoc-code .g{color:#f8f8f2}.pdoc-code .k{color:#66d9ef}.pdoc-code .l{color:#ae81ff}.pdoc-code .n{color:#f8f8f2}.pdoc-code .o{color:#f92672}.pdoc-code .x{color:#f8f8f2}.pdoc-code .p{color:#f8f8f2}.pdoc-code .ch{color:#75715e}.pdoc-code .cm{color:#75715e}.pdoc-code .cp{color:#75715e}.pdoc-code .cpf{color:#75715e}.pdoc-code .c1{color:#75715e}.pdoc-code .cs{color:#75715e}.pdoc-code .gd{color:#f92672}.pdoc-code .ge{color:#f8f8f2; font-style:italic}.pdoc-code .gr{color:#f8f8f2}.pdoc-code .gh{color:#f8f8f2}.pdoc-code .gi{color:#a6e22e}.pdoc-code .go{color:#66d9ef}.pdoc-code .gp{color:#f92672; font-weight:bold}.pdoc-code .gs{color:#f8f8f2; font-weight:bold}.pdoc-code .gu{color:#75715e}.pdoc-code .gt{color:#f8f8f2}.pdoc-code .kc{color:#66d9ef}.pdoc-code .kd{color:#66d9ef}.pdoc-code .kn{color:#f92672}.pdoc-code .kp{color:#66d9ef}.pdoc-code .kr{color:#66d9ef}.pdoc-code .kt{color:#66d9ef}.pdoc-code .ld{color:#e6db74}.pdoc-code .m{color:#ae81ff}.pdoc-code .s{color:#e6db74}.pdoc-code .na{color:#a6e22e}.pdoc-code .nb{color:#f8f8f2}.pdoc-code .nc{color:#a6e22e}.pdoc-code .no{color:#66d9ef}.pdoc-code .nd{color:#a6e22e}.pdoc-code .ni{color:#f8f8f2}.pdoc-code .ne{color:#a6e22e}.pdoc-code .nf{color:#a6e22e}.pdoc-code .nl{color:#f8f8f2}.pdoc-code .nn{color:#f8f8f2}.pdoc-code .nx{color:#a6e22e}.pdoc-code .py{color:#f8f8f2}.pdoc-code .nt{color:#f92672}.pdoc-code .nv{color:#f8f8f2}.pdoc-code .ow{color:#f92672}.pdoc-code .w{color:#f8f8f2}.pdoc-code .mb{color:#ae81ff}.pdoc-code .mf{color:#ae81ff}.pdoc-code .mh{color:#ae81ff}.pdoc-code .mi{color:#ae81ff}.pdoc-code .mo{color:#ae81ff}.pdoc-code .sa{color:#e6db74}.pdoc-code .sb{color:#e6db74}.pdoc-code .sc{color:#e6db74}.pdoc-code .dl{color:#e6db74}.pdoc-code .sd{color:#e6db74}.pdoc-code .s2{color:#e6db74}.pdoc-code .se{color:#ae81ff}.pdoc-code .sh{color:#e6db74}.pdoc-code .si{color:#e6db74}.pdoc-code .sx{color:#e6db74}.pdoc-code .sr{color:#e6db74}.pdoc-code .s1{color:#e6db74}.pdoc-code .ss{color:#e6db74}.pdoc-code .bp{color:#f8f8f2}.pdoc-code .fm{color:#a6e22e}.pdoc-code .vc{color:#f8f8f2}.pdoc-code .vg{color:#f8f8f2}.pdoc-code .vi{color:#f8f8f2}.pdoc-code .vm{color:#f8f8f2}</style>
    <style>/*! theme.css */:root{--pdoc-background:#212529;}.pdoc{--text:#f7f7f7;--muted:#9d9d9d;--link:#58a6ff;--link-hover:#3989ff;--code:#333;--active:#555;--accent:#343434;--accent2:#555;--nav-hover:rgba(0, 0, 0, 0.1);--name:#77C1FF;--def:#0cdd0c;--annotation:#00c037;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../tksbrokerapi.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;tksbrokerapi</a>

            <img src="https://github.com/Tim55667757/TKSBrokerAPI/blob/develop/docs/media/TKSBrokerAPI-Logo-text-only.png?raw=true" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#NANO">NANO</a>
            </li>
            <li>
                    <a class="variable" href="#FUZZY_SCALE">FUZZY_SCALE</a>
            </li>
            <li>
                    <a class="variable" href="#FUZZY_LEVELS">FUZZY_LEVELS</a>
            </li>
            <li>
                    <a class="variable" href="#SIGNAL_FILTER">SIGNAL_FILTER</a>
            </li>
            <li>
                    <a class="variable" href="#OPENING_RULES">OPENING_RULES</a>
            </li>
            <li>
                    <a class="variable" href="#CLOSING_RULES">CLOSING_RULES</a>
            </li>
            <li>
                    <a class="function" href="#CanOpen">CanOpen</a>
            </li>
            <li>
                    <a class="function" href="#CanClose">CanClose</a>
            </li>
            <li>
                    <a class="function" href="#RiskLong">RiskLong</a>
            </li>
            <li>
                    <a class="function" href="#RiskShort">RiskShort</a>
            </li>
            <li>
                    <a class="function" href="#ReachLong">ReachLong</a>
            </li>
            <li>
                    <a class="function" href="#ReachShort">ReachShort</a>
            </li>
            <li>
                    <a class="function" href="#FormatTimedelta">FormatTimedelta</a>
            </li>
            <li>
                    <a class="function" href="#GetDatesAsString">GetDatesAsString</a>
            </li>
            <li>
                    <a class="function" href="#NanoToFloat">NanoToFloat</a>
            </li>
            <li>
                    <a class="function" href="#FloatToNano">FloatToNano</a>
            </li>
            <li>
                    <a class="function" href="#UpdateClassFields">UpdateClassFields</a>
            </li>
            <li>
                    <a class="function" href="#SeparateByEqualParts">SeparateByEqualParts</a>
            </li>
            <li>
                    <a class="function" href="#CalculateLotsForDeal">CalculateLotsForDeal</a>
            </li>
            <li>
                    <a class="function" href="#HampelFilter">HampelFilter</a>
            </li>
            <li>
                    <a class="function" href="#HampelAnomalyDetection">HampelAnomalyDetection</a>
            </li>
            <li>
                    <a class="function" href="#CalculateAdaptiveCacheReserve">CalculateAdaptiveCacheReserve</a>
            </li>
            <li>
                    <a class="function" href="#HampelCleaner">HampelCleaner</a>
            </li>
            <li>
                    <a class="function" href="#LogReturns">LogReturns</a>
            </li>
            <li>
                    <a class="function" href="#MeanReturn">MeanReturn</a>
            </li>
            <li>
                    <a class="function" href="#Volatility">Volatility</a>
            </li>
            <li>
                    <a class="function" href="#ZScore">ZScore</a>
            </li>
            <li>
                    <a class="function" href="#BayesianAggregation">BayesianAggregation</a>
            </li>
            <li>
                    <a class="function" href="#VolatilityWeight">VolatilityWeight</a>
            </li>
            <li>
                    <a class="function" href="#RollingMean">RollingMean</a>
            </li>
            <li>
                    <a class="function" href="#RollingStd">RollingStd</a>
            </li>
            <li>
                    <a class="function" href="#FastBBands">FastBBands</a>
            </li>
            <li>
                    <a class="function" href="#FastPSAR">FastPSAR</a>
            </li>
            <li>
                    <a class="function" href="#FastHurst">FastHurst</a>
            </li>
            <li>
                    <a class="function" href="#FastSampEn">FastSampEn</a>
            </li>
            <li>
                    <a class="function" href="#FastDfa">FastDfa</a>
            </li>
            <li>
                    <a class="function" href="#ChaosMeasure">ChaosMeasure</a>
            </li>
            <li>
                    <a class="function" href="#ChaosConfidence">ChaosConfidence</a>
            </li>
            <li>
                    <a class="function" href="#PhaseLocation">PhaseLocation</a>
            </li>
            <li>
                    <a class="function" href="#PhaseConfidence">PhaseConfidence</a>
            </li>
            <li>
                    <a class="function" href="#AdjustProbabilityByChaosAndPhaseTrust">AdjustProbabilityByChaosAndPhaseTrust</a>
            </li>
            <li>
                    <a class="function" href="#EstimateTargetReachability">EstimateTargetReachability</a>
            </li>
    </ul>


            <footer>⚙ Technologies · Knowledge · Science</footer>

        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../tksbrokerapi.html">tksbrokerapi</a><wbr>.TradeRoutines    </h1>

                        <div class="docstring"><p><a href="https://github.com/Tim55667757/TKSBrokerAPI/blob/master/README_EN.md" target="_blank"><img src="https://github.com/Tim55667757/TKSBrokerAPI/blob/develop/docs/media/TKSBrokerAPI-Logo.png?raw=true" alt="TKSBrokerAPI-Logo" width="780" /></a></p>

<p><strong>T</strong>echnologies · <strong>K</strong>nowledge · <strong>S</strong>cience</p>

<p><a href="https://yoomoney.ru/fundraise/4WOyAgNgb7M.230111"><img src="https://badgen.net/badge/gift/donate/green" alt="gift" /></a></p>

<p>The <strong>TradeRoutines</strong> library contains some methods used by trade scenarios implemented with TKSBrokerAPI module.</p>

<ul>
<li><strong>TKSBrokerAPI module documentation:</strong> <a href="https://tim55667757.github.io/TKSBrokerAPI/docs/tksbrokerapi/TKSBrokerAPI.html">https://tim55667757.github.io/TKSBrokerAPI/docs/tksbrokerapi/TKSBrokerAPI.html</a></li>
<li><strong>TKSBrokerAPI CLI examples:</strong> <a href="https://github.com/Tim55667757/TKSBrokerAPI/blob/master/README_EN.md">https://github.com/Tim55667757/TKSBrokerAPI/blob/master/README_EN.md</a></li>
<li><strong>About Tinkoff Invest API:</strong> <a href="https://tinkoff.github.io/investAPI/">https://tinkoff.github.io/investAPI/</a></li>
<li><strong>Tinkoff Invest API documentation:</strong> <a href="https://tinkoff.github.io/investAPI/swagger-ui/">https://tinkoff.github.io/investAPI/swagger-ui/</a></li>
<li><strong>Open account for trading:</strong> <a href="https://tinkoff.ru/sl/AaX1Et1omnH">https://tinkoff.ru/sl/AaX1Et1omnH</a></li>
</ul>
</div>

                
                
                
            </section>
                <section id="NANO">
                    <div class="attr variable">
            <span class="name">NANO</span>        =
<span class="default_value">1e-09</span>

        
    </div>
    <a class="headerlink" href="#NANO"></a>
    
            <div class="docstring"><p>SI-constant: <code>NANO = 10^-9</code></p>
</div>


                </section>
                <section id="FUZZY_SCALE">
                    <div class="attr variable">
            <span class="name">FUZZY_SCALE</span>        =
<span class="default_value">&lt;fuzzyroutines.FuzzyRoutines.UniversalFuzzyScale object&gt;</span>

        
    </div>
    <a class="headerlink" href="#FUZZY_SCALE"></a>
    
            <div class="docstring"><p>Universal Fuzzy Scale is a special set of fuzzy levels: <code>{Min, Low, Med, High, Max}</code>.</p>
</div>


                </section>
                <section id="FUZZY_LEVELS">
                    <div class="attr variable">
            <span class="name">FUZZY_LEVELS</span>        =
<span class="default_value">[&#39;Min&#39;, &#39;Low&#39;, &#39;Med&#39;, &#39;High&#39;, &#39;Max&#39;]</span>

        
    </div>
    <a class="headerlink" href="#FUZZY_LEVELS"></a>
    
            <div class="docstring"><p>Level names on Universal Fuzzy Scale <code><a href="#FUZZY_SCALE">FUZZY_SCALE</a></code>. Default: <code>["Min", "Low", "Med", "High", "Max"]</code>.</p>
</div>


                </section>
                <section id="SIGNAL_FILTER">
                    <div class="attr variable">
            <span class="name">SIGNAL_FILTER</span>        =
<input id="SIGNAL_FILTER-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="SIGNAL_FILTER-view-value"></label><span class="default_value">{&#39;Max&#39;: {&#39;Max&#39;: &#39;Max&#39;, &#39;High&#39;: &#39;High&#39;, &#39;Med&#39;: &#39;Med&#39;, &#39;Low&#39;: &#39;Low&#39;, &#39;Min&#39;: &#39;Min&#39;}, &#39;High&#39;: {&#39;Max&#39;: &#39;High&#39;, &#39;High&#39;: &#39;Med&#39;, &#39;Med&#39;: &#39;Low&#39;, &#39;Low&#39;: &#39;Min&#39;, &#39;Min&#39;: &#39;Min&#39;}, &#39;Med&#39;: {&#39;Max&#39;: &#39;Med&#39;, &#39;High&#39;: &#39;Low&#39;, &#39;Med&#39;: &#39;Min&#39;, &#39;Low&#39;: &#39;Min&#39;, &#39;Min&#39;: &#39;Min&#39;}, &#39;Low&#39;: {&#39;Max&#39;: &#39;Low&#39;, &#39;High&#39;: &#39;Min&#39;, &#39;Med&#39;: &#39;Min&#39;, &#39;Low&#39;: &#39;Min&#39;, &#39;Min&#39;: &#39;Min&#39;}, &#39;Min&#39;: {&#39;Max&#39;: &#39;Min&#39;, &#39;High&#39;: &#39;Min&#39;, &#39;Med&#39;: &#39;Min&#39;, &#39;Low&#39;: &#39;Min&#39;, &#39;Min&#39;: &#39;Min&#39;}}</span>

        
    </div>
    <a class="headerlink" href="#SIGNAL_FILTER"></a>
    
            <div class="docstring"><p>Signal filter by default is used to reduce signal strength.</p>
</div>


                </section>
                <section id="OPENING_RULES">
                    <div class="attr variable">
            <span class="name">OPENING_RULES</span>        =
<input id="OPENING_RULES-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="OPENING_RULES-view-value"></label><span class="default_value">        Min    Low    Med   High    Max
Min   False  False   True   True   True
Low   False  False   True   True   True
Med   False  False   True   True   True
High  False  False  False  False  False
Max   False  False  False  False  False</span>

        
    </div>
    <a class="headerlink" href="#OPENING_RULES"></a>
    
            <div class="docstring"><p>Opening positions rules depend of fuzzy Risk/Reach levels.</p>

<p>This is the author's technique, proposed by <a href="https://www.linkedin.com/in/tgilmullin">Timur Gilmullin</a> and <a href="https://www.linkedin.com/in/mgilmullin">Mansur Gilmullin</a>,
based on fuzzy scales for measuring the levels of fuzzy risk and reachable. The following simple diagram explains what do we mean as Open/Close Fuzzy Rules:</p>

<p><img src="https://github.com/Tim55667757/TKSBrokerAPI/blob/develop/docs/media/005-Open-Close-Rules-Matrix.png?raw=true" alt="Open-Close-Rules-Matrix" style="display: block; margin-left: auto; margin-right: auto; width: 50%;" /></p>

<p>Here in table <code>T</code> mean <code>True</code>, <code>F</code> mean <code>False</code>. 1st position is for Opening rules, 2nd position is for Closing rules.
These rules are defined as transposed matrix constants <code><a href="#OPENING_RULES">OPENING_RULES</a></code> and <code><a href="#CLOSING_RULES">CLOSING_RULES</a></code>.</p>

<p>See also:</p>

<ul>
<li>An Engineering View of Trading: How a Trading Robot's Signal Algorithm Works: <a href="https://teletype.in/@tgilmullin/trading-algorithm">RU</a>.</li>
<li><a href="https://github.com/devopshq/FuzzyRoutines">FuzzyRoutines</a> library.</li>
<li>How to work with Universal Fuzzy Scales: <a href="https://github.com/devopshq/FuzzyRoutines#Chapter_2_4">EN</a>, <a href="https://math-n-algo.blogspot.com/2014/08/FuzzyClassificator.html#chapter_3">RU</a>.</li>
<li><code><a href="#CLOSING_RULES">CLOSING_RULES</a></code> constant, <code><a href="#CanOpen">CanOpen()</a></code> and <code><a href="#CanClose">CanClose()</a></code> methods.</li>
</ul>

<p>Default rules for opening positions:</p>

<table>
<thead>
<tr>
  <th>Risk \ Reach</th>
  <th>Min</th>
  <th>Low</th>
  <th>Med</th>
  <th>High</th>
  <th>Max</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Min</td>
  <td>False</td>
  <td>False</td>
  <td>True</td>
  <td>True</td>
  <td>True</td>
</tr>
<tr>
  <td>Low</td>
  <td>False</td>
  <td>False</td>
  <td>True</td>
  <td>True</td>
  <td>True</td>
</tr>
<tr>
  <td>Med</td>
  <td>False</td>
  <td>False</td>
  <td>True</td>
  <td>True</td>
  <td>True</td>
</tr>
<tr>
  <td>High</td>
  <td>False</td>
  <td>False</td>
  <td>False</td>
  <td>False</td>
  <td>False</td>
</tr>
<tr>
  <td>Max</td>
  <td>False</td>
  <td>False</td>
  <td>False</td>
  <td>False</td>
  <td>False</td>
</tr>
</tbody>
</table>
</div>


                </section>
                <section id="CLOSING_RULES">
                    <div class="attr variable">
            <span class="name">CLOSING_RULES</span>        =
<input id="CLOSING_RULES-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="CLOSING_RULES-view-value"></label><span class="default_value">        Min    Low    Med   High    Max
Min   False  False  False  False  False
Low   False  False  False  False  False
Med    True   True  False  False  False
High   True   True   True  False  False
Max    True   True   True  False  False</span>

        
    </div>
    <a class="headerlink" href="#CLOSING_RULES"></a>
    
            <div class="docstring"><p>Closing positions rules depend of fuzzy Risk/Reach levels. These rules are opposite for <code><a href="#OPENING_RULES">OPENING_RULES</a></code>
(see explanation there what do we mean as Open/Close Fuzzy Rules).</p>

<p>See also: <code><a href="#CanClose">CanClose()</a></code> method.</p>

<p>Default rules for closing positions:</p>

<table>
<thead>
<tr>
  <th>Risk \ Reach</th>
  <th>Min</th>
  <th>Low</th>
  <th>Med</th>
  <th>High</th>
  <th>Max</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Min</td>
  <td>False</td>
  <td>False</td>
  <td>False</td>
  <td>False</td>
  <td>False</td>
</tr>
<tr>
  <td>Low</td>
  <td>False</td>
  <td>False</td>
  <td>False</td>
  <td>False</td>
  <td>False</td>
</tr>
<tr>
  <td>Med</td>
  <td>True</td>
  <td>True</td>
  <td>False</td>
  <td>False</td>
  <td>False</td>
</tr>
<tr>
  <td>High</td>
  <td>True</td>
  <td>True</td>
  <td>True</td>
  <td>False</td>
  <td>False</td>
</tr>
<tr>
  <td>Max</td>
  <td>True</td>
  <td>True</td>
  <td>True</td>
  <td>False</td>
  <td>False</td>
</tr>
</tbody>
</table>
</div>


                </section>
                <section id="CanOpen">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">CanOpen</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">fuzzyRisk</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">fuzzyReach</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#CanOpen"></a>
    
            <div class="docstring"><p>Checks opening positions rules in <code><a href="#OPENING_RULES">OPENING_RULES</a></code> depend on fuzzy Risk/Reach levels.</p>

<p>See also:</p>

<ul>
<li><code><a href="#OPENING_RULES">OPENING_RULES</a></code> constant,</li>
<li><code><a href="#FUZZY_LEVELS">FUZZY_LEVELS</a></code> and <code><a href="#FUZZY_SCALE">FUZZY_SCALE</a></code> constants,</li>
<li><code><a href="#RiskLong">RiskLong()</a></code> and <code><a href="#RiskShort">RiskShort()</a></code> methods,</li>
<li><code><a href="#ReachLong">ReachLong()</a></code> and <code><a href="#ReachShort">ReachShort()</a></code> methods.</li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>fuzzyRisk</strong>:  Fuzzy Risk level name.</li>
<li><strong>fuzzyReach</strong>:  Fuzzy Reach level name.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Bool. If <code>True</code>, then possible to open position.</p>
</blockquote>
</div>


                </section>
                <section id="CanClose">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">CanClose</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">fuzzyRisk</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">fuzzyReach</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#CanClose"></a>
    
            <div class="docstring"><p>Checks closing positions rules in <code><a href="#CLOSING_RULES">CLOSING_RULES</a></code> depend on fuzzy Risk/Reach levels.</p>

<p>See also:</p>

<ul>
<li><code><a href="#CLOSING_RULES">CLOSING_RULES</a></code> constant,</li>
<li><code><a href="#FUZZY_LEVELS">FUZZY_LEVELS</a></code> and <code><a href="#FUZZY_SCALE">FUZZY_SCALE</a></code> constants,</li>
<li><code><a href="#RiskLong">RiskLong()</a></code> and <code><a href="#RiskShort">RiskShort()</a></code> methods,</li>
<li><code><a href="#ReachLong">ReachLong()</a></code> and <code><a href="#ReachShort">ReachShort()</a></code> methods.</li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>fuzzyRisk</strong>:  Fuzzy Risk level name.</li>
<li><strong>fuzzyReach</strong>:  Fuzzy Reach level name.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Bool. If <code>True</code>, then possible to close position.</p>
</blockquote>
</div>


                </section>
                <section id="RiskLong">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">RiskLong</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">curPrice</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">pHighest</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">pLowest</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#RiskLong"></a>
    
            <div class="docstring"><p>Function returns Risk as fuzzy level and percents of Risk in the range [0, 100], if you want buy from current price.</p>

<p>This is the author's method, proposed by <a href="https://www.linkedin.com/in/tgilmullin">Timur Gilmullin</a> and <a href="https://www.linkedin.com/in/mgilmullin">Mansur Gilmullin</a>,
based on fuzzy scales for measuring the levels of Fuzzy Risk. The following simple diagram explains what do we mean as Fuzzy Risk level:</p>

<p><img src="https://github.com/Tim55667757/TKSBrokerAPI/blob/develop/docs/media/003-Risk.png?raw=true" alt="Fuzzy-Risk" style="display: block; margin-left: auto; margin-right: auto; width: 50%;" /></p>

<ul>
<li>If open long (buy) position from current price: <code>RiskLong = Fuzzy(|P - L| / (H - L))</code>. Here:
<ul>
<li><code>P</code> is the current price,</li>
<li><code>L (H)</code> is the lowest (highest) price in forecasted movements of candles chain or prognoses diapason border of price movement,</li>
<li><code>Fuzzy()</code> is the fuzzyfication function that convert real values to its fuzzy representation.</li>
</ul></li>
</ul>

<p>See also:</p>

<ul>
<li>An Engineering View of Trading: How a Trading Robot's Signal Algorithm Works: <a href="https://teletype.in/@tgilmullin/trading-algorithm">RU</a>.</li>
<li><a href="https://github.com/devopshq/FuzzyRoutines">FuzzyRoutines</a> library.</li>
<li>How to work with Universal Fuzzy Scales: <a href="https://github.com/devopshq/FuzzyRoutines#Chapter_2_4">EN</a>, <a href="https://math-n-algo.blogspot.com/2014/08/FuzzyClassificator.html#chapter_3">RU</a>.</li>
<li><code><a href="#RiskShort">RiskShort()</a></code> method,</li>
<li><code><a href="#CanOpen">CanOpen()</a></code> and <code><a href="#CanClose">CanClose()</a></code> methods.</li>
<li><code><a href="#ReachLong">ReachLong()</a></code> and <code><a href="#ReachShort">ReachShort()</a></code> methods.</li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>curPrice</strong>:  Current actual price (usually the latest close price).</li>
<li><strong>pHighest</strong>:  The highest close price in forecasted movements of candles chain or prognosis of the highest diapason border of price movement.</li>
<li><strong>pLowest</strong>:  The lowest close price in forecasted movements of candles chain or prognosis of the lowest diapason border of price movement.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Dictionary with Fuzzy Risk level and Risk percents, e.g. <code>{"riskFuzzy": "High", "riskPercent": 66.67}</code>.</p>
</blockquote>
</div>


                </section>
                <section id="RiskShort">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">RiskShort</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">curPrice</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">pHighest</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">pLowest</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#RiskShort"></a>
    
            <div class="docstring"><p>Function returns Risk as fuzzy level and percents of Risk in the range [0, 100], if you want sell from current price.
This method is opposite for <code><a href="#RiskLong">RiskLong()</a></code> (see explanation there what do we mean as Fuzzy Risk).</p>

<ul>
<li>If open short (sell) position from current price: <code>RiskShort = Fuzzy(|P - H| / (H - L))</code>. Here:
<ul>
<li><code>P</code> is the current price,</li>
<li><code>L (H)</code> is the lowest (highest) price in forecasted movements of candles chain or prognoses diapason border of price movement,</li>
<li><code>Fuzzy()</code> is the fuzzyfication function that convert real values to its fuzzy representation.</li>
</ul></li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>curPrice</strong>:  Current actual price (usually the latest close price).</li>
<li><strong>pHighest</strong>:  The highest close price in forecasted movements of candles chain or prognosis of the highest diapason border of price movement.</li>
<li><strong>pLowest</strong>:  The lowest close price in forecasted movements of candles chain or prognosis of the lowest diapason border of price movement.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Dictionary with Fuzzy Risk level and Risk percents, e.g. <code>{"riskFuzzy": "Low", "riskPercent": 20.12}</code>.</p>
</blockquote>
</div>


                </section>
                <section id="ReachLong">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ReachLong</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">pClosing</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#ReachLong"></a>
    
            <div class="docstring"><p>The Fuzzy Reach is a value of forecast reachable of price (highest or lowest close). In this function we calculate
the reachability of the highest close price.</p>

<p>This is the author's method, proposed by <a href="https://www.linkedin.com/in/tgilmullin">Timur Gilmullin</a> and
<a href="https://www.linkedin.com/in/mgilmullin">Mansur Gilmullin</a>, based on fuzzy scales for measuring the levels
of Fuzzy Reach. The following simple diagram explains what is meant by the Fuzzy Reach level:</p>

<p><img src="https://github.com/Tim55667757/TKSBrokerAPI/blob/develop/docs/media/004-Reachability.png?raw=true" alt="Fuzzy-Reach" style="display: block; margin-left: auto; margin-right: auto; width: 50%;" /></p>

<p>There are fuzzy levels and percents in the range [0, 100] for the maximum and minimum forecasted close prices.
Prognosis horizon is divided by 5 parts of time diapason: I, II, III, IV and V, from the first forecasted candle (or price)
to the last forecasted candle (or price).</p>

<p>Every part correlate with some fuzzy level, depending on the distance in time from current actual candle (or price):</p>

<ul>
<li><code>I = Max</code>,</li>
<li><code>II = High</code>,</li>
<li><code>III = Med</code>,</li>
<li><code>IV = Low</code>,</li>
<li><code>V = Min</code>.</li>
</ul>

<p>This function search for first fuzzy level appropriate to the part of time diapason, where the close price (highest or lowest)
located in this diapason. Of course, you can use other price chains (open, high, low) instead of candle close prices,
but usually this is not recommended.</p>

<p><strong>Recommendation.</strong> If you have no prognosis chain of candles just use <code>"Med"</code> Fuzzy Reach level.</p>

<p>See also:</p>

<ul>
<li>An Engineering View of Trading: How a Trading Robot's Signal Algorithm Works: <a href="https://teletype.in/@tgilmullin/trading-algorithm">RU</a>.</li>
<li><code><a href="#OPENING_RULES">OPENING_RULES</a></code> and <code><a href="#CLOSING_RULES">CLOSING_RULES</a></code> constants,</li>
<li><code><a href="#CanOpen">CanOpen()</a></code> and <code><a href="#CanClose">CanClose()</a></code> methods,</li>
<li><code><a href="#FUZZY_LEVELS">FUZZY_LEVELS</a></code> and <code><a href="#FUZZY_SCALE">FUZZY_SCALE</a></code> constants,</li>
<li><code><a href="#RiskLong">RiskLong()</a></code> and <code><a href="#RiskShort">RiskShort()</a></code> methods,</li>
<li><code><a href="#ReachShort">ReachShort()</a></code> method.</li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>pClosing</strong>:  Pandas Series with prognosis chain of closing prices of candles. This is "close prices"
in OHLCV-formatted candles chain. The forecasted prices are indexed starting from zero,
this is the first candle of the forecast. The last price of the forecast is the "farthest"
relative to the current actual close price.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Dictionary with Fuzzy Reach level and Reach percents for the highest close price, e.g. <code>{"reachFuzzy": "Low", "reachPercent": 20.12}</code>.</p>
</blockquote>
</div>


                </section>
                <section id="ReachShort">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ReachShort</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">pClosing</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#ReachShort"></a>
    
            <div class="docstring"><p>The Fuzzy Reach is a value of forecast reachable of price (highest or lowest close). This method is similar like
<code><a href="#ReachLong">ReachLong()</a></code> (see explanation there what do we mean as Fuzzy Reach), but in this case we calculate the reachability
of the lowest close price.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>pClosing</strong>:  Pandas Series with prognosis chain of closing prices of candles. This is "close prices"
in OHLCV-formatted candles chain. The forecasted prices are indexed starting from zero,
this is the first candle of the forecast. The last price of the forecast is the "farthest"
relative to the current actual close price. <strong>Recommendation.</strong> If you have no prognosis chain
of candles just use <code>"Med"</code> Fuzzy Reach level.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Dictionary with Fuzzy Reach level and Reach percents for the lowest close price, e.g. <code>{"reachFuzzy": "High", "reachPercent": 66.67}</code>.</p>
</blockquote>
</div>


                </section>
                <section id="FormatTimedelta">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">FormatTimedelta</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">timeDelta</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span>, </span><span class="param"><span class="n">precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#FormatTimedelta"></a>
    
            <div class="docstring"><p>Format a timedelta object into a readable string like "0:00:12" or "0:00:12.34".</p>

<p>This function supports fixed-point precision formatting for seconds.
Fractional seconds are rounded to the specified number of digits.
No brackets are added — raw string like "H:MM:SS.ss" is returned.</p>

<p>If the precision is invalid (not an int or out of range [0..6]),
the function will return the default string representation of the timedelta.</p>

<p>Examples:</p>

<p>FormatTimedelta(timedelta(seconds=12.987), precision=0) -> "0:00:12"
FormatTimedelta(timedelta(seconds=12.987), precision=1) -> "0:00:12.9"
FormatTimedelta(timedelta(seconds=12.987), precision=2) -> "0:00:12.99"
FormatTimedelta(timedelta(seconds=12.987), precision=5) -> "0:00:12.98700"
FormatTimedelta(timedelta(seconds=12.987), precision="bad") -> "0:00:12.987000"</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>timeDelta</strong>:  Timedelta object to format.</li>
<li><strong>precision</strong>:  Integer from 0 to 6 — how many digits to keep after seconds.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Formatted time string like "0:00:12" or "0:00:12.34". If precision is invalid, returns str(timeDelta).</p>
</blockquote>
</div>


                </section>
                <section id="GetDatesAsString">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">GetDatesAsString</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">start</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">end</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">userFormat</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span>,</span><span class="param">	<span class="n">outputFormat</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">T%H:%M:%SZ&#39;</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#GetDatesAsString"></a>
    
            <div class="docstring"><p>Create tuple of date and time strings with timezone parsed from user-friendly date.</p>

<p>Warning! All dates must be in UTC time zone!</p>

<p>User dates format must be like: <code>"%Y-%m-%d"</code>, e.g. <code>"2020-02-03"</code> (3 Feb, 2020).</p>

<p>Output date is UTC ISO time format by default: <code>"%Y-%m-%dT%H:%M:%SZ"</code>.</p>

<p>Example input: <code>start="2022-06-01", end="2022-06-20"</code> -> output: <code>("2022-06-01T00:00:00Z", "2022-06-20T23:59:59Z")</code>.
An error exception will occur if input date has incorrect format.</p>

<p>If <code>start=None</code>, <code>end=None</code> then return dates from yesterday to the end of the day.</p>

<p>If <code>start=some_date_1</code>, <code>end=None</code> then return dates from <code>some_date_1</code> to the end of the day.</p>

<p>If <code>start=some_date_1</code>, <code>end=some_date_2</code> then return dates from start of <code>some_date_1</code> to end of <code>some_date_2</code>.</p>

<p>Start day may be negative integer numbers: <code>-1</code>, <code>-2</code>, <code>-3</code> — how many days ago.</p>

<p>Also, you can use keywords for start if <code>end=None</code>:</p>

<ul>
<li><code>today</code> (from 00:00:00 to the end of current day),</li>
<li><code>yesterday</code> (-1 day from 00:00:00 to 23:59:59),</li>
<li><code>week</code> (-7 day from 00:00:00 to the end of current day),</li>
<li><code>month</code> (-30 day from 00:00:00 to the end of current day),</li>
<li><code>year</code> (-365 day from 00:00:00 to the end of current day).</li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>start</strong>:  start day in format defined by <code>userFormat</code> or keyword.</li>
<li><strong>end</strong>:  end day in format defined by <code>userFormat</code>.</li>
<li><strong>userFormat</strong>:  user-friendly date format, e.g. <code>"%Y-%m-%d"</code>.</li>
<li><strong>outputFormat</strong>:  output string date format.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>tuple with 2 strings <code>("start", "end")</code>. Example of return is <code>("2022-06-01T00:00:00Z", "2022-06-20T23:59:59Z")</code>.
           Second string is the end of the last day.
           Tuple ("", "") returned if errors occurred.</p>
</blockquote>
</div>


                </section>
                <section id="NanoToFloat">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">NanoToFloat</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">units</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">nano</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#NanoToFloat"></a>
    
            <div class="docstring"><p>Convert number in nano-view mode with string parameter <code>units</code> and integer parameter <code>nano</code> to float view.</p>

<p>Examples:</p>

<ul>
<li><code>NanoToFloat(units="2", nano=500000000) -&gt; 2.5</code></li>
<li><code>NanoToFloat(units="0", nano=50000000) -&gt; 0.05</code></li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>units</strong>:  integer string or integer parameter that represents the integer part of number</li>
<li><strong>nano</strong>:  integer string or integer parameter that represents the fractional part of number</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>float view of number. If an error occurred, then returns <code>0.</code>.</p>
</blockquote>
</div>


                </section>
                <section id="FloatToNano">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">FloatToNano</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">number</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#FloatToNano"></a>
    
            <div class="docstring"><p>Convert float number to nano-type view: dictionary with string <code>units</code> and integer <code>nano</code> parameters <code>{"units": "string", "nano": integer}</code>.</p>

<p>Examples:</p>

<ul>
<li><code>FloatToNano(number=2.5) -&gt; {"units": "2", "nano": 500000000}</code></li>
<li><code>FloatToNano(number=0.05) -&gt; {"units": "0", "nano": 50000000}</code></li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>number</strong>:  float number.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>nano-type view of number: <code>{"units": "string", "nano": integer}</code>.
           If an error occurred, then returns <code>{"units": "0", "nano": 0}</code>.</p>
</blockquote>
</div>


                </section>
                <section id="UpdateClassFields">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">UpdateClassFields</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">instance</span><span class="p">:</span> <span class="nb">object</span>, </span><span class="param"><span class="n">params</span><span class="p">:</span> <span class="nb">dict</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#UpdateClassFields"></a>
    
            <div class="docstring"><p>This method get config as dictionary (preloaded from YAML file) and apply <code>key: value</code> as names of class fields and
values of class fields. Example for class <code>TradeScenario</code>:
<code>config["tickers"] = ["TICKER1", "TICKER2"] ==&gt; TradeScenario(TinkoffBrokerServer).tickers = ["TICKER1", "TICKER2"]</code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>instance</strong>:  instance of class to parametrize.</li>
<li>**params: dict with all parameters in <code>key**:  value</code> format. It will be nothing with object if an error occurred.</li>
</ul>
</div>


                </section>
                <section id="SeparateByEqualParts">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">SeparateByEqualParts</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">elements</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>,</span><span class="param">	<span class="n">parts</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>,</span><span class="param">	<span class="n">union</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#SeparateByEqualParts"></a>
    
            <div class="docstring"><p>Gets input list and try to separate it by equal parts of elements.</p>

<p>Examples:</p>

<ul>
<li><code>SeparateByEqualParts([1, 2, 3, 4, 5, 6, 7, 8, 9, 10], parts=2) -&gt; [[1, 2, 3, 4, 5], [6, 7, 8, 9, 10]]</code></li>
<li><code>SeparateByEqualParts([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], parts=2, union=True) -&gt; [[0, 1, 2, 3, 4], [5, 6, 7, 8, 9, 10]]</code></li>
<li><code>SeparateByEqualParts([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], parts=2, union=False) -&gt; [[0, 1, 2, 3, 4], [5, 6, 7, 8, 9], [10]]]</code></li>
<li><code>SeparateByEqualParts([1, 2, 3], parts=2, union=True) -&gt; [[1], [2, 3]]</code></li>
<li><code>SeparateByEqualParts([1, 2, 3], parts=2, union=False) -&gt; [[1], [2], [3]]</code></li>
</ul>

<p>If parts &gt; length of elements:</p>

<ul>
<li><code>SeparateByEqualParts([1], parts=2, union=True) -&gt; [[1]]</code></li>
<li><code>SeparateByEqualParts([1, 2, 3], parts=4, union=True) -&gt; [[1], [2], [3]]</code></li>
<li><code>SeparateByEqualParts([1], parts=2, union=False) -&gt; [[1], []]</code></li>
<li><code>SeparateByEqualParts([1, 2, 3], parts=4, union=False) -&gt; [[1], [2], [3], []]</code></li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>elements</strong>:  list of objects.</li>
<li><strong>parts</strong>:  int, numbers of equal parts of objects.</li>
<li><strong>union</strong>:  bool, if True and if the remainder of the separating not empty, then remainder part union with the last part.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>list of lists with equal parts of objects. If an error occurred, then returns empty list <code>[]</code>.</p>
</blockquote>
</div>


                </section>
                <section id="CalculateLotsForDeal">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">CalculateLotsForDeal</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">currentPrice</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">maxCost</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">volumeInLot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span></span><span class="return-annotation">) -> <span class="nb">int</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#CalculateLotsForDeal"></a>
    
            <div class="docstring"><p>Calculates maximum lots for deal depends on current price and volume of instrument in one lot.</p>

<p>Formula: <code>lots = maxCost // (currentPrice * volumeInLot)</code>, it means max count of lots, for which will be:
<code>cost = lots * currentPrice * volumeInLot &lt;= maxCost</code>.</p>

<p>If <code>costOneLot = currentPrice * volumeInLot &gt; maxCost</code>, then returned <code>lots = 1</code>.</p>

<p>If an error occurred then returned <code>lots = 0</code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>currentPrice</strong>:  the current price of instrument, &gt;= 0.</li>
<li><strong>maxCost</strong>:  the maximum cost of all lots of instrument in portfolio, &gt;= 0.</li>
<li><strong>volumeInLot</strong>:  volumes of instrument in one lot, &gt;= 1.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>integer number of lots, &gt;= 0.</p>
</blockquote>
</div>


                </section>
                <section id="HampelFilter">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">HampelFilter</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">series</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span><span class="p">]</span>,</span><span class="param">	<span class="n">window</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span>,</span><span class="param">	<span class="n">sigma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">3</span>,</span><span class="param">	<span class="n">scaleFactor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.4826</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#HampelFilter"></a>
    
            <div class="docstring"><p>Outlier Detection with Hampel Filter. It can detect outliers based on a sliding window and counting difference
between median values and input values of series. The Hampel filter is often considered extremely effective in practice.</p>

<p>For each window, we calculate the Median and the Median Absolute Deviation (MAD). If the considered observation
differs from the window median by more than sigma standard deviations multiple on scaleFactor, then we treat it
as an outlier.</p>

<p>Let Xi — elements of input series in the i-th window,
s — sigma, the number of standard deviations,
k — scale factor, depend on distribution (≈1.4826 for normal).</p>

<p>How to calculate rolling MAD: <code>MAD(Xi) = Median(|x1 − Median (Xi)|, ..., |xn − Median(Xi)|)</code></p>

<p>What is an anomaly: <code>A = {a | |a − Median (Xi)| &gt; s ∙ k ∙ MAD(Xi)}</code></p>

<p>References:</p>

<ol>
<li>Gilmullin T.M., Gilmullin M.F. How to quickly find anomalies in number series using the Hampel method:
<ul>
<li>Link (RU): <a href="https://teletype.in/@tgilmullin/anomaly"><a href="https://teletype.in/@tgilmullin/anomaly">https://teletype.in/@tgilmullin/anomaly</a></a></li>
<li>Link (EN): <a href="https://forworktests.blogspot.com/2023/01/how-to-quickly-find-anomalies-in-number.html"><a href="https://forworktests.blogspot.com/2023/01/how-to-quickly-find-anomalies-in-number.html">https://forworktests.blogspot.com/2023/01/how-to-quickly-find-anomalies-in-number.html</a></a></li>
</ul></li>
<li>Lewinson Eryk. Outlier Detection with Hampel Filter. September 26, 2019.
<ul>
<li>Link: <a href="https://towardsdatascience.com/outlier-detection-with-hampel-filter-85ddf523c73d"><a href="https://towardsdatascience.com/outlier-detection-with-hampel-filter-85ddf523c73d">https://towardsdatascience.com/outlier-detection-with-hampel-filter-85ddf523c73d</a></a></li>
</ul></li>
<li>Hancong Liu, Sirish Shah and Wei Jiang. On-line outlier detection and data cleaning. Computers and Chemical Engineering. Vol. 28, March 2004, pp. 1635–1647.
<ul>
<li>Link: <a href="https://sites.ualberta.ca/~slshah/files/on_line_outlier_det.pdf"><a href="https://sites.ualberta.ca/~slshah/files/on_line_outlier_det.pdf">https://sites.ualberta.ca/~slshah/files/on_line_outlier_det.pdf</a></a></li>
</ul></li>
<li>Hampel F. R. The influence curve and its role in robust estimation. Journal of the American Statistical Association, 69, 382–393, 1974.</li>
</ol>

<p>Examples:</p>

<ul>
<li><code>HampelFilter([1, 1, 1, 1, 1, 1], window=3) -&gt; pd.Series([False, False, False, False, False, False])</code></li>
<li><code>HampelFilter([1, 1, 1, 2, 1, 1], window=3) -&gt; pd.Series([False, False, False, True, False, False])</code></li>
<li><code>HampelFilter([0, 1, 1, 1, 1, 0], window=3) -&gt; pd.Series([True, False, False, False, False, True])</code></li>
<li><code>HampelFilter([1], window=3) -&gt; pd.Series([False])</code></li>
<li><code>HampelFilter([5, 5, 50, 5, 5], window=2) -&gt; pd.Series([False, False, True, False, False])</code></li>
<li><code>HampelFilter([100, 1, 1, 1, 1, 100], window=2) -&gt; pd.Series([True, False, False, False, False, True])</code></li>
<li><code>HampelFilter([1, 1, 10, 1, 10, 1, 1], window=2) -&gt; pd.Series([False, False, True, False, True, False, False])</code></li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>series</strong>:  Pandas Series object with numbers in which we identify outliers.</li>
<li><strong>window</strong>:  length of the sliding window (5 points by default), 1 &lt;= window &lt;= len(series).</li>
<li><strong>sigma</strong>:  sigma is the number of standard deviations which identify the outlier (3 sigma by default), &gt; 0.</li>
<li><strong>scaleFactor</strong>:  constant scale factor (1.4826 by default for Gaussian distribution), &gt; 0.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Pandas Series object with True/False values.
           <code>True</code> means that an outlier detected in that position of input series.
           If an error occurred, then empty series returned.</p>
</blockquote>
</div>


                </section>
                <section id="HampelAnomalyDetection">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">HampelAnomalyDetection</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">series</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span><span class="p">]</span>,</span><span class="param">	<span class="n">compareWithMax</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#HampelAnomalyDetection"></a>
    
            <div class="docstring"><p>Anomaly Detection function using Hampel Filter. This function returns the minimum index of elements in an anomaly list
or index of the first maximum element in the input series if this index is less than anomaly element index.
If the series has no anomalies, then <code>None</code> will be returned.</p>

<p>Anomaly filter is a function:
F: X → {True, False}. F(xi) = True, if xi ∈ A; False, if xi ∉ A, where X — input series with xi elements, A — anomaly set.</p>

<p>References:</p>

<ol>
<li>Gilmullin T.M., Gilmullin M.F. How to quickly find anomalies in number series using the Hampel method. December 27, 2022.
<ul>
<li>Link (RU): <a href="https://teletype.in/@tgilmullin/anomaly"><a href="https://teletype.in/@tgilmullin/anomaly">https://teletype.in/@tgilmullin/anomaly</a></a></li>
<li>Link (EN): <a href="https://forworktests.blogspot.com/2023/01/how-to-quickly-find-anomalies-in-number.html"><a href="https://forworktests.blogspot.com/2023/01/how-to-quickly-find-anomalies-in-number.html">https://forworktests.blogspot.com/2023/01/how-to-quickly-find-anomalies-in-number.html</a></a></li>
</ul></li>
<li>Jupyter Notebook with examples:
<ul>
<li>Link (EN): <a href="https://nbviewer.org/github/Tim55667757/TKSBrokerAPI/blob/develop/docs/examples/HampelFilteringExample_EN.ipynb"><a href="https://nbviewer.org/github/Tim55667757/TKSBrokerAPI/blob/develop/docs/examples/HampelFilteringExample_EN.ipynb">https://nbviewer.org/github/Tim55667757/TKSBrokerAPI/blob/develop/docs/examples/HampelFilteringExample_EN.ipynb</a></a></li>
<li>Link (RU): <a href="https://nbviewer.org/github/Tim55667757/TKSBrokerAPI/blob/develop/docs/examples/HampelFilteringExample.ipynb"><a href="https://nbviewer.org/github/Tim55667757/TKSBrokerAPI/blob/develop/docs/examples/HampelFilteringExample.ipynb">https://nbviewer.org/github/Tim55667757/TKSBrokerAPI/blob/develop/docs/examples/HampelFilteringExample.ipynb</a></a></li>
</ul></li>
<li>Simple Python script demonstrates how to use Hampel Filter to determine anomalies in time series:
<ul>
<li>Link: <a href="https://github.com/Tim55667757/TKSBrokerAPI/blob/develop/docs/examples/TestAnomalyFilter.py"><a href="https://github.com/Tim55667757/TKSBrokerAPI/blob/develop/docs/examples/TestAnomalyFilter.py">https://github.com/Tim55667757/TKSBrokerAPI/blob/develop/docs/examples/TestAnomalyFilter.py</a></a></li>
</ul></li>
</ol>

<p>Examples:</p>

<ul>
<li><code>HampelAnomalyDetection([1, 1, 1, 1, 1, 1]) -&gt; None</code></li>
<li><code>HampelAnomalyDetection([1, 1, 1, 1, 111, 1]) -&gt; 4</code></li>
<li><code>HampelAnomalyDetection([1, 1, 10, 1, 1, 1]) -&gt; 2</code></li>
<li><code>HampelAnomalyDetection([111, 1, 1, 1, 1, 1]) -&gt; 0</code></li>
<li><code>HampelAnomalyDetection([111, 1, 1, 1, 1, 111]) -&gt; 0</code></li>
<li><code>HampelAnomalyDetection([1, 11, 1, 111, 1, 1]) -&gt; 1</code></li>
<li><code>HampelAnomalyDetection([1, 1, 1, 111, 99, 11]) -&gt; 3</code></li>
<li><code>HampelAnomalyDetection([1, 1, 11, 111, 1, 1, 1, 11111]) -&gt; 2</code></li>
<li><code>HampelAnomalyDetection([1, 1, 1, 111, 111, 1, 1, 1, 1]) -&gt; 3</code></li>
<li><code>HampelAnomalyDetection([1, 1, 1, 1, 111, 1, 1, 11111, 5555]) -&gt; 4</code></li>
<li><code>HampelAnomalyDetection([9, 13, 12, 12, 13, 12, 12, 13, 12, 12, 13, 12, 12, 13, 12, 13, 12, 12, 1, 1]) -&gt; 0</code></li>
<li><code>HampelAnomalyDetection([9, 13, 12, 12, 13, 12, 1000, 13, 12, 12, 300000, 12, 12, 13, 12, 2000, 1, 1, 1, 1]) -&gt; 0</code></li>
</ul>

<p>Some **kwargs parameters you can pass to <code><a href="#HampelFilter">HampelFilter()</a></code>:</p>

<ul>
<li><code>window</code> is the length of the sliding window (5 points by default), 1 &lt;= window &lt;= len(series).</li>
<li><code>sigma</code> is the number of standard deviations which identify the outlier (3 sigma by default), &gt; 0.</li>
<li><code>scaleFactor</code> is the constant scale factor (1.4826 by default), &gt; 0.</li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>series</strong>:  List or Pandas Series of numeric values to check for anomalies.</li>
<li><strong>compareWithMax</strong>:  If <code>True</code> (default), returns min(index of anomaly, index of first maximum).
If <code>False</code>, returns only the first anomaly index detected by <code><a href="#HampelFilter">HampelFilter</a></code>.</li>
<li><strong>kwargs</strong>:  Additional parameters are forwarded to <code><a href="#HampelFilter">HampelFilter()</a></code>.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Index of the first anomaly (or intersection with maximum, if enabled). Returns <code>None</code> if no anomaly is found.</p>
</blockquote>
</div>


                </section>
                <section id="CalculateAdaptiveCacheReserve">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">CalculateAdaptiveCacheReserve</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">drawdowns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">curDrawdown</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">reserve</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">portfolioValue</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">amplificationFactor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.25</span>,</span><span class="param">	<span class="n">amplificationSensitivity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#CalculateAdaptiveCacheReserve"></a>
    
            <div class="docstring"><p>Calculates the adaptive target cash reserve based on current and historical portfolio drawdowns.</p>

<p>This function dynamically adjusts the reserve allocated for averaging positions (e.g., during drawdowns).
If the drawdown increases for several consecutive iterations, the reserve is amplified exponentially.
If the drawdown stabilizes or decreases, the reserve is reset to the base level.</p>

<p>The amplification is computed as:
    amplification = amplificationFactor × exp(growStreak × amplificationSensitivity)</p>

<p>Where:</p>

<ul>
<li><code>growStreak</code> is the number of consecutive days the drawdown has been increasing, including the current day.</li>
<li><code>amplificationFactor</code> is the base multiplier.</li>
<li><code>amplificationSensitivity</code> controls how aggressively the amplification grows with each additional drawdown increase.</li>
</ul>

<p>Example:</p>

<p>With amplificationFactor = 1.25 and amplificationSensitivity = 0.1, if the drawdown increases for 3 days:
    amplification = 1.25 × exp(0.3) ≈ 1.25 × 1.3499 ≈ 1.687</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>drawdowns</strong>:  historical portfolio drawdowns (fractions between 0 and 1);
drawdowns[0] is the oldest, drawdowns[-1] is the most recent.</li>
<li><strong>curDrawdown</strong>:  current portfolio drawdown at the time of calculation.</li>
<li><strong>reserve</strong>:  base reserve ratio (e.g., 0.05 means 5% of the portfolio value).</li>
<li><strong>portfolioValue</strong>:  current portfolio value (in currency units).</li>
<li><strong>amplificationFactor</strong>:  base multiplier for reserve amplification (default is 1.25).</li>
<li><strong>amplificationSensitivity</strong>:  exponential growth rate of amplification per growStreak step (default is 0.1).</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>calculated target cash reserve in portfolio currency units.</p>
</blockquote>
</div>


                </section>
                <section id="HampelCleaner">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">HampelCleaner</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">series</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span>,</span><span class="param">	<span class="n">window</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span>,</span><span class="param">	<span class="n">sigma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">3</span>,</span><span class="param">	<span class="n">scaleFactor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.4826</span>,</span><span class="param">	<span class="n">strategy</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;neighborAvg&#39;</span>,</span><span class="param">	<span class="n">fallbackValue</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">medianWindow</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#HampelCleaner"></a>
    
            <div class="docstring"><p>Replaces outliers in a time series using the Hampel filter and a selected replacement strategy.</p>

<p>This function detects anomalies using the Hampel method and replaces them according to the specified strategy.
It is designed for use in financial time series, sensor data, or any numerical sequences requiring robust cleaning
before further analysis (e.g., volatility estimation, trend modeling, probability forecasting).</p>

<p>Available replacement strategies:</p>

<ul>
<li><p>"neighborAvg": average of adjacent neighbors (default).
Best for stable, low-noise time series where local continuity matters.</p></li>
<li><p>"prev": previous non-outlier value.
Suitable for cumulative or trend-sensitive series, avoids abrupt distortions.</p></li>
<li><p>"const": fixed fallback value.
Recommended when anomalies reflect technical failures (e.g., spikes due to API glitches).</p></li>
<li><p>"medianWindow": local window median (uses medianWindow size).
Robust to single-point noise and short bursts of volatility; good for candle data.</p></li>
<li><p>"rollingMean": centered rolling mean over the window (same as a Hampel window).
Applies smooth correction while preserving a general shape; works well for low-volatility assets.</p></li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>series</strong>:  input time series as a Pandas Series of floats.</li>
<li><strong>window</strong>:  sliding window size used in Hampel filtering (<code>5</code> by default).</li>
<li><strong>sigma</strong>:  threshold multiplier for anomaly detection (<code>3</code> by default).</li>
<li><strong>scaleFactor</strong>:  scaling factor for the MAD (<code>1.4826</code> by default, optimal for Gaussian data).</li>
<li><strong>strategy</strong>:  strategy used to replace detected outliers (see the list above).</li>
<li><strong>fallbackValue</strong>:  constantly used as a fallback in "const" strategy or when neighbors are missing.</li>
<li><strong>medianWindow</strong>:  window size used for the "medianWindow" strategy.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>cleaned time series as a Pandas Series with outliers replaced.</p>
</blockquote>
</div>


                </section>
                <section id="LogReturns">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">LogReturns</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">series</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#LogReturns"></a>
    
            <div class="docstring"><p>Calculates logarithmic returns for a time series of prices.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>series</strong>:  A series of close prices.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A series of log returns.</p>
</blockquote>
</div>


                </section>
                <section id="MeanReturn">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">MeanReturn</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">logReturns</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#MeanReturn"></a>
    
            <div class="docstring"><p>Computes the mean return from a log-return series.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>logReturns</strong>:  A series of log returns.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The average return.</p>
</blockquote>
</div>


                </section>
                <section id="Volatility">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">Volatility</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">logReturns</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span>, </span><span class="param"><span class="n">ddof</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#Volatility"></a>
    
            <div class="docstring"><p>Computes the sample standard deviation of log returns using specified Bessel correction.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>logReturns</strong>:  A series of log returns.</li>
<li><strong>ddof</strong>:  Degrees of freedom for Bessel's correction (1 by default, use 2 per methodology).</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Volatility (standard deviation).</p>
</blockquote>
</div>


                </section>
                <section id="ZScore">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ZScore</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">logTargetRatio</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">meanReturn</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">volatility</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#ZScore"></a>
    
            <div class="docstring"><p>Computes the standardized deviation (z-score) using geometric Brownian motion with drift and volatility.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>logTargetRatio</strong>:  Logarithm of (targetPrice / currentPrice).</li>
<li><strong>meanReturn</strong>:  Estimated mean of log returns (μ).</li>
<li><strong>volatility</strong>:  Estimated volatility of log returns (σ).</li>
<li><strong>horizon</strong>:  Forecast horizon (number of candles).</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>z-score value (float).</p>
</blockquote>
</div>


                </section>
                <section id="BayesianAggregation">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">BayesianAggregation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">p1</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">p2</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#BayesianAggregation"></a>
    
            <div class="docstring"><p>Combines two conditional probabilities using Bayesian aggregation.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>p1</strong>:  First probability.</li>
<li><strong>p2</strong>:  Second probability.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Aggregated probability using Bayesian fusion.</p>
</blockquote>
</div>


                </section>
                <section id="VolatilityWeight">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">VolatilityWeight</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">sigmaLow</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">sigmaHigh</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#VolatilityWeight"></a>
    
            <div class="docstring"><p>Computes a dynamic weight coefficient based on relative volatility of two timeframes.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>sigmaLow</strong>:  Volatility from the lower timeframe (faster/shorter interval).</li>
<li><strong>sigmaHigh</strong>:  Volatility from the higher timeframe (slower/longer interval).</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Weight alpha in the range [0.0, 1.0], prioritizing a higher timeframe when its volatility is higher.</p>
</blockquote>
</div>


                </section>
                <section id="RollingMean">
                    <div class="attr function">
                    <div class="decorator">@jit(nopython=True)</div>

        <span class="def">def</span>
        <span class="name">RollingMean</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">array</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>, </span><span class="param"><span class="n">window</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#RollingMean"></a>
    
            <div class="docstring"><p>Calculates a simple moving average (SMA) using a sliding window over a NumPy array with running sum optimization.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>array</strong>:  A NumPy array of input data (e.g., closing prices).</li>
<li><strong>window</strong>:  The size of the rolling window for calculating the average. Must be a positive integer.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A NumPy array containing the rolling mean values, with NaNs for positions before the first full window.</p>
</blockquote>
</div>


                </section>
                <section id="RollingStd">
                    <div class="attr function">
                    <div class="decorator">@jit(nopython=True)</div>

        <span class="def">def</span>
        <span class="name">RollingStd</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">array</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>, </span><span class="param"><span class="n">window</span><span class="p">:</span> <span class="nb">int</span>, </span><span class="param"><span class="n">ddof</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#RollingStd"></a>
    
            <div class="docstring"><p>Calculates a rolling standard deviation over a NumPy array using a sliding window.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>array</strong>:  A NumPy array of input data (e.g., closing prices).</li>
<li><strong>window</strong>:  The size of the rolling window for calculating standard deviation.</li>
<li><strong>ddof</strong>:  Delta degrees of freedom. Default is <code>1</code>.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A NumPy array containing the rolling standard deviation values.</p>
</blockquote>
</div>


                </section>
                <section id="FastBBands">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">FastBBands</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">close</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>,</span><span class="param">	<span class="n">length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span>,</span><span class="param">	<span class="n">std</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span>,</span><span class="param">	<span class="n">ddof</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n">Optional</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#FastBBands"></a>
    
            <div class="docstring"><p>Calculates Bollinger Bands (BBANDS) using a fast NumPy-based implementation.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>close</strong>:  Series or array of closing prices.</li>
<li><strong>length</strong>:  Rolling window size for the moving average and standard deviation. The default is <code>5</code>.</li>
<li><strong>std</strong>:  Number of standard deviations to determine the width of the bands. The default is <code>2.0</code>.</li>
<li><strong>ddof</strong>:  Delta degrees of freedom for standard deviation calculation. Default is <code>0</code>.</li>
<li><strong>offset</strong>:  How many periods to offset the resulting bands. The default is <code>0</code>.</li>
<li><p><strong>kwargs</strong>:  Optional keyword arguments are forwarded for filling missing values.</p>

<p>Supported options (with default values):</p>

<ul>
<li><code>fillna</code> (<code>None</code>): Value to fill missing data points (NaN values).</li>
<li><code>fill_method</code> (<code>None</code>): Method to fill missing data points (e.g., <code>ffill</code>, <code>bfill</code>).</li>
</ul></li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A pandas DataFrame containing the following columns:
      - <code>lower</code>: Lower Bollinger Band.
      - <code>mid</code>: Middle band (simple moving average).
      - <code>upper</code>: Upper Bollinger Band.
      - <code>bandwidth</code>: Percentage bandwidth between upper and lower bands.
      - <code>percent</code>: Position of the close price within the bands (from <code>0</code> to <code>1</code>).
      Returns <code>None</code> if the input is invalid.</p>
</blockquote>
</div>


                </section>
                <section id="FastPSAR">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">FastPSAR</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">high</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>,</span><span class="param">	<span class="n">low</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>,</span><span class="param">	<span class="n">af0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.02</span>,</span><span class="param">	<span class="n">af</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">maxAf</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span>,</span><span class="param">	<span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n">Optional</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#FastPSAR"></a>
    
            <div class="docstring"><p>Calculates the Parabolic SAR (PSAR) indicator using a fast NumPy-based implementation.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>high</strong>:  Series or array of high prices.</li>
<li><strong>low</strong>:  Series or array of low prices.</li>
<li><strong>af0</strong>:  Initial Acceleration Factor. The default is <code>0.02</code>.</li>
<li><strong>af</strong>:  Acceleration Factor (not used separately, defaults to <code>af0</code>). Default is <code>None</code>.</li>
<li><strong>maxAf</strong>:  Maximum Acceleration Factor. The default is <code>0.2</code>.</li>
<li><strong>offset</strong>:  How many periods to offset the resulting arrays. The default is <code>0</code>.</li>
<li><p><strong>kwargs</strong>:  Optional keyword arguments are forwarded for filling missing values.</p>

<p>Supported options (with default values):</p>

<ul>
<li><code>fillna</code> (<code>None</code>): Value to fill missing data points (NaN values).</li>
<li><code>fill_method</code> (<code>None</code>): Method to fill missing values (e.g., <code>ffill</code>, <code>bfill</code>).</li>
</ul></li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A pandas DataFrame containing the following columns:
      - <code>long</code>: SAR points for long trends (upward movement).
      - <code>short</code>: SAR points for short trends (downward movement).
      - <code>af</code>: Acceleration Factor values over time.
      - <code>reversal</code>: <code>1</code> if reversal detected on this candle, otherwise <code>0</code>.
      Returns <code>None</code> if input is invalid.</p>
</blockquote>
</div>


                </section>
                <section id="FastHurst">
                    <div class="attr function">
                    <div class="decorator">@jit(nopython=True)</div>

        <span class="def">def</span>
        <span class="name">FastHurst</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">series</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#FastHurst"></a>
    
            <div class="docstring"><p>Fast estimation of Hurst exponent using the rescaled range (R/S) method.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>series</strong>:  NumPy array of prices (1D).</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Hurst exponent ∈ [0.0, 1.0].</p>
</blockquote>
</div>


                </section>
                <section id="FastSampEn">
                    <div class="attr function">
                    <div class="decorator">@jit(nopython=True)</div>

        <span class="def">def</span>
        <span class="name">FastSampEn</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">series</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">embeddingDim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>,</span><span class="param">	<span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#FastSampEn"></a>
    
            <div class="docstring"><p>Fast Sample Entropy for chaos estimation.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>series</strong>:  NumPy array of floats.</li>
<li><strong>embeddingDim</strong>:  Embedding dimension m.</li>
<li><strong>tolerance</strong>:  Tolerance r.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Sample entropy.</p>
</blockquote>
</div>


                </section>
                <section id="FastDfa">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">FastDfa</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">series</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>, </span><span class="param"><span class="n">scale</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">12</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#FastDfa"></a>
    
            <div class="docstring"><p>Fast Detrended Fluctuation Analysis (DFA) estimator.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>series</strong>:  NumPy array of floats.</li>
<li><strong>scale</strong>:  Box size for detrending.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Scaling exponent alpha.</p>
</blockquote>
</div>


                </section>
                <section id="ChaosMeasure">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ChaosMeasure</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">series</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>, </span><span class="param"><span class="n">model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;hurst&#39;</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#ChaosMeasure"></a>
    
            <div class="docstring"><p>Dispatches to a selected chaos estimation model.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>series</strong>:  NumPy array of floats.</li>
<li><strong>model</strong>:  One of the values
<ul>
<li><code>hurst</code>: fast estimation of Hurst exponent using the rescaled range (R/S) method, <code><a href="#FastHurst">FastHurst()</a></code>;</li>
<li><code>sampen</code>: fast Sample Entropy for chaos estimation, see <code><a href="#FastSampEn">FastSampEn()</a></code>;</li>
<li><code>dfa</code>: fast Detrended Fluctuation Analysis (DFA) estimator, see <code><a href="#FastDfa">FastDfa()</a></code>.</li>
</ul></li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Chaos value.</p>
</blockquote>
</div>


                </section>
                <section id="ChaosConfidence">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ChaosConfidence</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">value</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">model</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#ChaosConfidence"></a>
    
            <div class="docstring"><p>Converts chaos metric value into the trust coefficient in [0.0, 1.0].</p>

<p>For supported models:
    - hurst: symmetric parabola with peak at <code>0.5</code>;
    - dfa: linear fade from <code>0.5</code>;
    - sampen: inverse — low entropy means high trust.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>value</strong>:  Chaos measures value.</li>
<li><strong>model</strong>:  One of the values
<ul>
<li><code>hurst</code>: fast estimation of Hurst exponent using the rescaled range (R/S) method, <code><a href="#FastHurst">FastHurst()</a></code>;</li>
<li><code>sampen</code>: fast Sample Entropy for chaos estimation, see <code><a href="#FastSampEn">FastSampEn()</a></code>;</li>
<li><code>dfa</code>: fast Detrended Fluctuation Analysis (DFA) estimator, see <code><a href="#FastDfa">FastDfa()</a></code>.</li>
</ul></li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Confidence coefficient ∈ [0.0, 1.0].</p>
</blockquote>
</div>


                </section>
                <section id="PhaseLocation">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">PhaseLocation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">price</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">lower</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">upper</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#PhaseLocation"></a>
    
            <div class="docstring"><p>Normalized phase location of price in [0.0, 1.0] inside the Bollinger channel.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>price</strong>:  Current price of the asset.</li>
<li><strong>lower</strong>:  Lower Bollinger band.</li>
<li><strong>upper</strong>:  Upper Bollinger band.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Phase position ∈ [0.0, 1.0], where 0.0 is bottom, 1.0 is top.</p>
</blockquote>
</div>


                </section>
                <section id="PhaseConfidence">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">PhaseConfidence</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">phase</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">direction</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#PhaseConfidence"></a>
    
            <div class="docstring"><p>Trust modifier based on the current phase and direction of signal.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>phase</strong>:  Normalized price position ∈ [0.0, 1.0] in the channel.</li>
<li><strong>direction</strong>:  Signal direction — must be <code>Buy</code> or <code>Sell</code>.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Confidence modifier ∈ [0.0, 1.0].</p>
</blockquote>
</div>


                </section>
                <section id="AdjustProbabilityByChaosAndPhaseTrust">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">AdjustProbabilityByChaosAndPhaseTrust</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">pModel</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">chaos</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">phase</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">wModel</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>,</span><span class="param">	<span class="n">wChaos</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span>,</span><span class="param">	<span class="n">wPhase</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#AdjustProbabilityByChaosAndPhaseTrust"></a>
    
            <div class="docstring"><p>Final-adjusted probability after applying chaos and phase trust modifiers.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>pModel</strong>:  Base probability from the main model.</li>
<li><strong>chaos</strong>:  Chaos trust coefficient ∈ [0.0, 1.0].</li>
<li><strong>phase</strong>:  Phase trust coefficient ∈ [0.0, 1.0].</li>
<li><strong>wModel</strong>:  Weight for the original model probability.</li>
<li><strong>wChaos</strong>:  Weight for chaos confidence.</li>
<li><strong>wPhase</strong>:  Weight for phase confidence.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Adjusted probability ∈ [0.0, 1.0].</p>
</blockquote>
</div>


                </section>
                <section id="EstimateTargetReachability">
                    <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">EstimateTargetReachability</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">seriesLowTF</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span><span class="p">]</span>,</span><span class="param">	<span class="n">seriesHighTF</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span><span class="p">]</span>,</span><span class="param">	<span class="n">currentPrice</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">targetPrice</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">horizonLowTF</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">horizonHighTF</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">ddof</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>,</span><span class="param">	<span class="n">cleanWithHampel</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">useChaos</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">chaosModel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;hurst&#39;</span>,</span><span class="param">	<span class="n">chaosTail</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">usePhase</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">phaseDirection</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

        
    </div>
    <a class="headerlink" href="#EstimateTargetReachability"></a>
    
            <div class="docstring"><p>Estimates the probability of reaching a target price using two price series from different timeframes.
Implements full methodology: log returns, volatility with Bessel correction, effective drift, z-score,
cumulative probability, Bayesian aggregation, volatility-based weighting, and fuzzy classification.</p>

<p>References:</p>

<ol>
<li><p>(RU article) <a href="https://teletype.in/@tgilmullin/target-probability">https://teletype.in/@tgilmullin/target-probability</a>
Will the Price Hit the Target: Assessing Probability Instead of Guessing.</p></li>
<li><p>(RU article on which the formulas are based)
Statistical Estimation of the Probability of Reaching a Target Price Considering Volatility and Returns Across Different Timeframes.</p></li>
</ol>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>seriesLowTF</strong>:  A close-price series from the lower timeframe.</li>
<li><strong>seriesHighTF</strong>:  A close-price series from the higher timeframe.</li>
<li><strong>currentPrice</strong>:  The current price of the asset.</li>
<li><strong>targetPrice</strong>:  The target price to be reached or exceeded.</li>
<li><strong>horizonLowTF</strong>:  The forecast horizon in candles for the lower timeframe.</li>
<li><strong>horizonHighTF</strong>:  The forecast horizon in candles for the higher timeframe.</li>
<li><strong>ddof</strong>:  Degrees of freedom for volatility estimation (use 2 as per article).</li>
<li><strong>cleanWithHampel</strong>:  If <code>True</code>, applies outlier cleaning to both input series before computing log returns
using <code><a href="#HampelCleaner">HampelCleaner()</a></code> (<code>False</code> by default). Recommended for real market data where spikes,
anomalies, or gaps may distort volatility and probability estimates.</li>
<li><strong>useChaos</strong>:  If <code>True</code>, modifies the final probability based on chaos confidence (Hurst, DFA, etc.).</li>
<li><strong>chaosModel</strong>:  Chaos model to use
<ul>
<li><code>hurst</code>: fast estimation of Hurst exponent using the rescaled range (R/S) method, <code><a href="#FastHurst">FastHurst()</a></code>;</li>
<li><code>sampen</code>: fast Sample Entropy for chaos estimation, see <code><a href="#FastSampEn">FastSampEn()</a></code>;</li>
<li><code>dfa</code>: fast Detrended Fluctuation Analysis (DFA) estimator, see <code><a href="#FastDfa">FastDfa()</a></code>.</li>
</ul></li>
<li><strong>chaosTail</strong>:  Optional tail length of the series <code>seriesLowTF</code> and <code>seriesHighTF</code> used for chaos estimation. If <code>None</code>, use the full series.</li>
<li><strong>usePhase</strong>:  If <code>True</code>, modifies the final probability based on Bollinger-band phase, see <code><a href="#FastBBands">FastBBands()</a></code>.</li>
<li><strong>phaseDirection: Trade direction</strong>:  <code>Buy</code> or <code>Sell</code> (required for phase confidence).</li>
<li><strong>kwargs</strong>:  Optional keyword arguments are forwarded to <code><a href="#HampelCleaner">HampelCleaner()</a></code> if <code>cleanWithHampel</code> is <code>True</code>.
           Supported options (with default values):
<ul>
<li><code>window</code> (5): Sliding window size for <code><a href="#HampelCleaner">HampelCleaner()</a></code>.</li>
<li><code>sigma</code> (3): Threshold multiplier for anomaly detection.</li>
<li><code>scaleFactor</code> (<code>1.4826</code>): Scaling factor for MAD.</li>
<li><code>strategy</code> (default <code>neighborAvg</code>): Outlier replacement strategy:
• <code>neighborAvg</code> – average of adjacent neighbors. Good for a smooth, low-noise series.
• <code>prev</code> – previous valid value. Preserves a trend direction.
• <code>const</code> – constant fallback. Use for API glitches or corrupted data.
• <code>medianWindow</code> – local median window. <strong>Best default for real-world candles.</strong>
• <code>rollingMean</code> – centered mean smoothing for low-volatility series.</li>
<li><code>fallbackValue</code> (<code>0.0</code>): Constant value for use in <code>const</code> strategy or edge cases.</li>
<li><code>medianWindow</code> (<code>3</code>): Window size for <code>"medianWindow"</code> strategy.</li>
</ul></li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A tuple <code>(pFinal, fFinal)</code>, where:
      - <code>pFinal</code> is a float in range <code>[0.0, 1.0]</code> — final adjusted probability of reaching the target,
         optionally modified by chaos and phase confidence if enabled.
      - <code>fFinal</code> is a fuzzy label: one of <code>["Min", "Low", "Med", "High", "Max"]</code>, based on <code>pFinal</code>.</p>
</blockquote>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>